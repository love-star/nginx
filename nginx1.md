本地dns服务器数据广播倒dns服务器

广播时间<24h 

ttl 更新时间，数据同步

域名 <-> ip

ip <->指向物理服务器

一个域名可以映射多个ip

CDN:

client <-------IO--------- ngnix ---------域名IP映射------->client

全国布置节点 -- 国内节点

国外用户 -- 国外节点

主干ISP 布置nginx

​	nginx 放置 html静态资源、骨架、反向代理

动静分离：

​	动态请求 --> tomcat

​	静态请求 --> nginx

cdn服务器都有一个last modified 属性

静态文件如何维护

配置多个IP

达到基于各个域名的负载均衡，经过哪个

一个IP唯一对应一个物理服务器

域名解析为IP 与CDN的原理相同

智能DNS 广播数据

知道client的IP ----- 哪个IP供应商 ------ 全网布置服务器 --------- ISP多节点访问 -------- 不同区域机房 ---------- 低延迟

IP地址符合全网络最近

nginx服务器 ---------- 全网服务

CDN利用时间戳更新动态请求

CDN提供动态请求的镜像

本机动态服务生成静态文件，可以分发到全网

5s更新一次 常变化的库存评论

其他触发请求

异步的更新 MQ 消费MQ Ajax异步请求

按钮点击之前 不生成动态请求 使用静态文件

优化加载层级

生成页面时，计算成本比较高

数据闭环

库存 价格位于两个不同的数据库

取出存到本地

评论 推荐独立分组

html骨架

通用css js

名称 

库存‘

详情 商品推荐 评论

Ajax异步请求

敏感数据

请求备份

异地数据备份

风险平摊

容灾备份

LRU 缓存清除算法

http_proxy_cache 文件缓存，缓存到前端的代理服务器磁盘

本地磁盘缓存 高性能 通过Linux内存磁盘空间映射mmap

zookeeper分发资源思想

应用服务集群 ----socket，nio，网络数据同步---- 应用系统DNS服务主节点 -----netty，socket同步---- 分发到nginx服务器



client -----CDN集群（nginx，http_proxy_cache） ---------- nginx文件服务器，数据中心

缓存数据达到ttl时间 更新数据

cdn过滤请求 削峰 流量清洗

app 逐渐让小程序代替



app -------------脚本，代码-------------- 服务接口 

app ui开发 通过内嵌的web浏览器进行request请求 缓存

例如魔兽世界

C，C++的引擎和骨架

lua的脚本

外挂 hook

maven 组织构建项目工具

app 不同平台有不同请求方案的热更新

游戏脚本更新lua

app store 全量更新

缓存

请求上加速 高可用负载均衡

Tegine内部可以跑lua脚本 性能和C语言模块相当

全网分发静态服务

